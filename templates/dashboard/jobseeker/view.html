{% extends "dashboard/base.html" %}
{% load thumbnail %}
{% load tz %}
{% load static %}
{% load page_tags %}

{% block stage %}
<style>
/* Modern Applicant View Styling */
.applicant-view-page {
    background: #f8fafc;
    min-height: 100vh;
    padding: 24px;
}

.page-header {
    background: white;
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #e2e8f0;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
}

.applicant-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #e2e8f0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.applicant-info {
    flex: 1;
    min-width: 300px;
}

.applicant-name {
    font-size: 1.75rem;
    font-weight: 700;
    color: #1e293b;
    margin: 0 0 8px 0;
}

.applicant-email {
    color: #3b82f6;
    font-size: 1.1rem;
    font-weight: 500;
    text-decoration: none;
    margin-bottom: 12px;
    display: block;
}

.applicant-email:hover {
    text-decoration: underline;
}

.applicant-status {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
}

.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
}

.status-active {
    background: #dcfce7;
    color: #166534;
}

.status-inactive {
    background: #fee2e2;
    color: #dc2626;
}

.profile-completion {
    background: #dbeafe;
    color: #1e40af;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
}

.registration-type {
    background: #f1f5f9;
    color: #475569;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
}

.social-integration {
    display: flex;
    gap: 8px;
    align-items: center;
}

.social-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    text-decoration: none;
    transition: all 0.2s ease;
}

.social-icon.connected {
    background: #dcfce7;
    color: #166534;
}

.social-icon.connected:hover {
    background: #bbf7d0;
    transform: translateY(-2px);
}

.social-icon.not-connected {
    background: #f1f5f9;
    color: #9ca3af;
}

.main-content {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 24px;
}

.sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.content-section {
    background: white;
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #e2e8f0;
}

.section-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0 0 20px 0;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-title i {
    color: #3b82f6;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.info-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.info-value {
    font-size: 0.95rem;
    font-weight: 500;
    color: #1e293b;
}

.info-value.error {
    color: #dc2626;
    font-style: italic;
}

.info-value a {
    color: #3b82f6;
    text-decoration: none;
}

.info-value a:hover {
    text-decoration: underline;
}

.tabs-section {
    background: white;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #e2e8f0;
    overflow: hidden;
}

.tabs-header {
    display: flex;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
    overflow-x: auto;
}

.tab-button {
    padding: 16px 20px;
    background: none;
    border: none;
    font-size: 0.9rem;
    font-weight: 500;
    color: #64748b;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 3px solid transparent;
}

.tab-button:hover {
    background: #f1f5f9;
    color: #475569;
}

.tab-button.active {
    background: white;
    color: #3b82f6;
    border-bottom-color: #3b82f6;
}

.tab-content {
    display: none;
    padding: 24px;
}

.tab-content.active {
    display: block;
}

.skills-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.skill-tag {
    background: #dbeafe;
    color: #1e40af;
    padding: 6px 12px;
    border-radius: 16px;
    font-size: 0.85rem;
    font-weight: 500;
}

.skill-tag.major {
    background: #dcfce7;
    color: #166534;
    font-weight: 600;
}

.resume-section {
    background: #f8fafc;
    border: 2px dashed #cbd5e1;
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    transition: all 0.2s ease;
    cursor: pointer;
}

.resume-section:hover {
    border-color: #3b82f6;
    background: #eff6ff;
}

.resume-icon {
    font-size: 2rem;
    color: #3b82f6;
    margin-bottom: 8px;
}

.resume-name {
    font-size: 1rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0;
}

.resume-download {
    font-size: 0.85rem;
    color: #64748b;
    margin-top: 4px;
}

.table-modern {
    width: 100%;
    border-collapse: collapse;
    margin-top: 16px;
}

.table-modern th {
    background: #f8fafc;
    color: #475569;
    font-weight: 600;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
}

.table-modern td {
    padding: 16px;
    border-bottom: 1px solid #f1f5f9;
    font-size: 0.9rem;
    color: #374151;
}

.table-modern tr:hover {
    background: #f8fafc;
}

.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #64748b;
}

.empty-state-icon {
    font-size: 2.5rem;
    color: #cbd5e1;
    margin-bottom: 16px;
}

.empty-state-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: #475569;
    margin: 0 0 8px 0;
}

.empty-state-text {
    font-size: 0.95rem;
    color: #64748b;
    margin: 0;
}

.job-card {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
    transition: all 0.2s ease;
}

.job-card:hover {
    border-color: #3b82f6;
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
}

.job-title {
    font-size: 1rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0 0 8px 0;
}

.job-title a {
    color: #3b82f6;
    text-decoration: none;
}

.job-title a:hover {
    text-decoration: underline;
}

.job-meta {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    font-size: 0.85rem;
    color: #64748b;
}

.alert-card {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
}

.alert-title {
    font-size: 1rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0 0 12px 0;
}

.alert-title a {
    color: #3b82f6;
    text-decoration: none;
}

.alert-title a:hover {
    text-decoration: underline;
}

.alert-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 12px;
}

.alert-detail {
    font-size: 0.85rem;
}

.alert-detail-label {
    font-weight: 600;
    color: #64748b;
    margin-bottom: 4px;
}

.alert-detail-value {
    color: #374151;
}

@media (max-width: 1024px) {
    .main-content {
        grid-template-columns: 1fr;
    }
    
    .header-content {
        flex-direction: column;
        text-align: center;
    }
    
    .applicant-info {
        min-width: auto;
    }
}

@media (max-width: 768px) {
    .applicant-view-page {
        padding: 16px;
    }
    
    .tabs-header {
        flex-direction: column;
    }
    
    .tab-button {
        border-bottom: none;
        border-right: 3px solid transparent;
    }
    
    .tab-button.active {
        border-right-color: #3b82f6;
        border-bottom-color: transparent;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
    }
    
    .alert-details {
        grid-template-columns: 1fr;
    }
}
</style>

<div class="applicant-view-page">
    <!-- Page Header -->
    <div class="page-header">
        <div class="header-content">
            <img src="{% if applicant.photo %}{{ applicant.photo }}{% else %}{% static 'dummy.jpg' %}{% endif %}" 
                 alt="{{ applicant.username }}" class="applicant-avatar">
            
            <div class="applicant-info">
                <h1 class="applicant-name">{{ applicant.username }}</h1>
                <a href="mailto:{{ applicant.email }}" class="applicant-email">{{ applicant.email }}</a>
                
                <div class="applicant-status">
                    <span class="status-badge {% if applicant.is_active %}status-active{% else %}status-inactive{% endif %}">
                        {% if applicant.is_active %}Active{% else %}Inactive{% endif %}
                    </span>
                    <span class="profile-completion">{{ applicant.profile_completion_percentage }}% Complete</span>
                    <span class="registration-type">
                        {% if applicant.registered_from == 'Email' %}Manual{% else %}Social{% endif %}
                    </span>
                </div>
                
                <div class="social-integration">
                    <a href="{% if applicant.is_fb_connected %}{{applicant.get_facebook_object.facebook_url}}{% else %}#{% endif %}" 
                       target="_blank" class="social-icon {% if applicant.is_fb_connected %}connected{% else %}not-connected{% endif %}">
                        <i class="fa-brands fa-facebook-f"></i>
                    </a>
                    <a href="{% if applicant.is_gh_connected %}{{applicant.get_github_object.git_url}}{% else %}#{% endif %}" 
                       target="_blank" class="social-icon {% if applicant.is_gh_connected %}connected{% else %}not-connected{% endif %}">
                        <i class="fa-brands fa-github"></i>
                    </a>
                    <a href="{% if applicant.is_so_connected %}{{applicant.get_stack_overflow_object.link}}{% else %}#{% endif %}" 
                       target="_blank" class="social-icon {% if applicant.is_so_connected %}connected{% else %}not-connected{% endif %}">
                        <i class="fa-brands fa-stack-overflow"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Basic Information -->
            <div class="content-section">
                <h2 class="section-title">
                    <i class="fa fa-user"></i>
                    Basic Information
                </h2>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">First Name</span>
                        <span class="info-value">{{ applicant.first_name|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Last Name</span>
                        <span class="info-value">{{ applicant.last_name|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Date of Birth</span>
                        <span class="info-value">{{ applicant.dob|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Gender</span>
                        <span class="info-value">{{ applicant.gender|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Mobile</span>
                        <span class="info-value">{{ applicant.mobile|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Marital Status</span>
                        <span class="info-value">{{ applicant.marital_status|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Current Location</span>
                        <span class="info-value">{{ applicant.current_city.name|default:"Not specified" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Registered On</span>
                        <span class="info-value">{{ applicant.date_joined|timezone:"Asia/Calcutta"|date:"M d, Y" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Last Login</span>
                        <span class="info-value">{{ applicant.last_login|timezone:"Asia/Calcutta"|date:"M d, Y" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Profile Updated</span>
                        <span class="info-value">{{ applicant.profile_updated|timezone:"Asia/Calcutta"|date:"M d, Y" }}</span>
                    </div>
                </div>
            </div>

            <!-- Resume Section -->
            {% if applicant.resume %}
            <div class="content-section">
                <h2 class="section-title">
                    <i class="fa fa-file-text"></i>
                    Resume
                </h2>
                <div class="resume-section download" id="{{ applicant.resume|get_s3_url }}">
                    <div class="resume-icon">
                        <i class="fa fa-file-pdf"></i>
                    </div>
                    <h3 class="resume-name">{{ applicant.resume|get_resume_name }}</h3>
                    <p class="resume-download">Click to download</p>
                </div>
            </div>
            {% endif %}

            <!-- Major Skills -->
            {% if applicant.get_major_skills %}
            <div class="content-section">
                <h2 class="section-title">
                    <i class="fa fa-star"></i>
                    Major Skills
                </h2>
                <div class="skills-grid">
                    {% for skill in applicant.get_major_skills %}
                        <span class="skill-tag major">{{ skill.skill.name }}</span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Main Content -->
        <div class="tabs-section">
            <!-- Tabs Header -->
            <div class="tabs-header">
                <button class="tab-button active" data-tab="profile">
                    <i class="fa fa-user"></i>
                    Profile
                </button>
                <button class="tab-button {% if applicant.is_gh_connected %}active{% endif %}" data-tab="github">
                    <i class="fa fa-github"></i>
                    GitHub
                </button>
                <button class="tab-button" data-tab="applied_jobs">
                    <i class="fa fa-check-square-o"></i>
                    Applied Jobs
                </button>
                <button class="tab-button" data-tab="visited_jobs">
                    <i class="fa fa-eye"></i>
                    Visited Jobs
                </button>
                <button class="tab-button" data-tab="skills_subscribed">
                    <i class="fa fa-envelope"></i>
                    Skills Subscribed
                </button>
                <button class="tab-button" data-tab="search_done">
                    <i class="fa fa-search"></i>
                    Search Done
                </button>
                <button class="tab-button" data-tab="alerts_created">
                    <i class="fa fa-bell"></i>
                    Alerts Created
                </button>
            </div>

            <!-- Profile Tab -->
            <div class="tab-content active" id="profile">
                <!-- Profile Details -->
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-map-marker-alt"></i>
                        Location Details
                    </h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Current Location</span>
                            <span class="info-value">{{ applicant.current_city.name|default:"Not specified" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Preferred Locations</span>
                            <span class="info-value">
                                {% if applicant.preferred_city.all %}
                                    {% for location in applicant.preferred_city.all %}
                                        {{ location.name }}{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                {% else %}
                                    <span class="error">Not specified</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Present Address</span>
                            <span class="info-value">{{ applicant.address|default:"Not specified" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Permanent Address</span>
                            <span class="info-value">{{ applicant.permanent_address|default:"Not specified" }}</span>
                        </div>
                    </div>
                </div>

                <!-- Professional Info -->
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-briefcase"></i>
                        Professional Information
                    </h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Total Experience</span>
                            <span class="info-value">
                                {% if applicant.year %}
                                    {{ applicant.year }} Year(s) {{ applicant.month }} Month(s)
                                {% else %}
                                    <span class="error">Not specified</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Preferred Industry</span>
                            <span class="info-value">{{ applicant.prefered_industry.name|default:"Not specified" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Current Salary</span>
                            <span class="info-value">
                                {% if applicant.current_salary %}
                                    <i class="fa fa-inr"></i> {{ applicant.current_salary|get_formatted_salary }}
                                {% else %}
                                    <span class="error">Not specified</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Expected Salary</span>
                            <span class="info-value">
                                {% if applicant.expected_salary %}
                                    <i class="fa fa-inr"></i> {{ applicant.expected_salary|get_formatted_salary }}
                                {% else %}
                                    <span class="error">Not specified</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Job Role</span>
                            <span class="info-value">{{ applicant.job_role|default:"Not specified" }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Notice Period</span>
                            <span class="info-value">{{ applicant.notice_period|default:"Not specified" }}</span>
                        </div>
                    </div>
                </div>

                <!-- Profile Description -->
                {% if applicant.profile_description %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-file-alt"></i>
                        Profile Description
                    </h3>
                    <p style="color: #374151; line-height: 1.6;">{{ applicant.profile_description }}</p>
                </div>
                {% endif %}

                <!-- Employment History -->
                {% if applicant.employment_history.all %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-building"></i>
                        Employment History
                    </h3>
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Company</th>
                                <th>Designation</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Salary</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for history in applicant.employment_history.all %}
                            <tr>
                                <td>{{ history.company }}</td>
                                <td>{{ history.designation }}</td>
                                <td>{{ history.from_date }}</td>
                                <td>{% if history.to_date == None %}Till Now{% else %}{{ history.to_date }}{% endif %}</td>
                                <td>
                                    {% if history.salary %}
                                        <i class="fa fa-inr"></i> {{ history.salary|get_formatted_salary }}
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}

                <!-- Education Details -->
                {% if applicant.education.all %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-graduation-cap"></i>
                        Education Details
                    </h3>
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Institute</th>
                                <th>Degree</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Specialization</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for education in applicant.education.all %}
                            <tr>
                                <td>{{ education.institute.name }}</td>
                                <td>{{ education.degree.degree_name }}</td>
                                <td>{{ education.from_date }}</td>
                                <td>{% if education.to_date == None %}Till Now{% else %}{{ education.to_date }}{% endif %}</td>
                                <td>{{ education.degree.specialization }}</td>
                                <td>{{ education.score|default:"Not specified" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}

                <!-- Technical Skills -->
                {% if applicant.skills.all %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-code"></i>
                        Technical Skills
                    </h3>
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Experience</th>
                                <th>Version</th>
                                <th>Proficiency</th>
                                <th>Last Used</th>
                                <th>Is Major</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for skill in applicant.skills.all %}
                            <tr>
                                <td>{{ skill.skill.name }}</td>
                                <td>{{ skill.year }} Yr {{ skill.month }} months</td>
                                <td>{{ skill.version|default:"Not specified" }}</td>
                                <td>{{ skill.proficiency|default:"Not specified" }}</td>
                                <td>{{ skill.last_used|default:"Not specified" }}</td>
                                <td>{{ skill.is_major }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}

                <!-- Project Details -->
                {% if applicant.project.all %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-project-diagram"></i>
                        Project Details
                    </h3>
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Duration</th>
                                <th>Skills</th>
                                <th>Location</th>
                                <th>Role</th>
                                <th>Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for project in applicant.project.all %}
                            <tr>
                                <td>{{ project.name }}</td>
                                <td>{{ project.from_date }} - {% if project.to_date %}{{ project.to_date }}{% else %}Not specified{% endif %}</td>
                                <td>
                                    {% for skill in project.skills.all %}
                                        {{ skill.name }}{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </td>
                                <td>{{ project.location.name|default:"Not specified" }}</td>
                                <td>{{ project.role|default:"Not specified" }}</td>
                                <td>{{ project.size|default:"Not specified" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}

                <!-- Languages -->
                {% if applicant.language.all %}
                <div class="content-section">
                    <h3 class="section-title">
                        <i class="fa fa-language"></i>
                        Languages
                    </h3>
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Language</th>
                                <th>Read</th>
                                <th>Write</th>
                                <th>Speak</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for language in applicant.language.all %}
                            <tr>
                                <td>{{ language.language.name }}</td>
                                <td>{{ language.read }}</td>
                                <td>{{ language.write }}</td>
                                <td>{{ language.speak }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}
            </div>

            <!-- GitHub Tab -->
            <div class="tab-content" id="github">
                {% if applicant.is_gh_connected %}
                    {% with applicant.get_github_object as github %}
                    <div class="content-section">
                        <h3 class="section-title">
                            <i class="fa fa-github"></i>
                            GitHub Profile
                        </h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">GitHub Name</span>
                                <span class="info-value">
                                    <a href="{{github.git_url}}" target="_blank">{{ github.name }}</a>
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">GitHub ID</span>
                                <span class="info-value">{{ github.id }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Company</span>
                                <span class="info-value">{{ github.company|default:"Not specified" }}</span>
                            </div>
                        </div>
                    </div>
                    {% endwith %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-github"></i>
                        </div>
                        <h3 class="empty-state-title">GitHub Not Connected</h3>
                        <p class="empty-state-text">This user has not connected their GitHub account.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Applied Jobs Tab -->
            <div class="tab-content" id="applied_jobs">
                {% if applicant.get_all_applied_jobs %}
                    {% for job in applicant.get_all_applied_jobs %}
                    <div class="job-card">
                        <h3 class="job-title">
                            <a href="/dashboard/jobpost/view/{{ job.job_post.id }}/">{{ job.job_post.title }}</a>
                        </h3>
                        <div class="job-meta">
                            <span><i class="fa fa-user"></i> {{ job.job_post.user.email }}</span>
                            <span><i class="fa fa-calendar"></i> {{ job.job_post.applied_on }}</span>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-check-square-o"></i>
                        </div>
                        <h3 class="empty-state-title">No Applied Jobs</h3>
                        <p class="empty-state-text">This user has not applied to any jobs yet.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Visited Jobs Tab -->
            <div class="tab-content" id="visited_jobs">
                {% if applicant.get_visited_jobs %}
                    {% for job in applicant.get_visited_jobs %}
                    <div class="job-card">
                        <h3 class="job-title">
                            <a href="/dashboard/jobpost/view/{{ job.job_post.id }}/">{{ job.job_post.title }}</a>
                        </h3>
                        <div class="job-meta">
                            <span><i class="fa fa-user"></i> {{ job.job_post.user.email }}</span>
                            <span><i class="fa fa-calendar"></i> {{ job.visited_on }}</span>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-eye"></i>
                        </div>
                        <h3 class="empty-state-title">No Visited Jobs</h3>
                        <p class="empty-state-text">This user has not visited any job pages yet.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Skills Subscribed Tab -->
            <div class="tab-content" id="skills_subscribed">
                {% if applicant.get_subscribed_skills %}
                    {% for skill in applicant.get_subscribed_skills %}
                    <div class="job-card">
                        <h3 class="job-title">
                            <a href="{{skill.get_job_url}}" target="_blank">{{ skill.name }}</a>
                        </h3>
                        <div class="job-meta">
                            <span><i class="fa fa-briefcase"></i> {{skill.get_no_of_jobposts|length}} Job Posts</span>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-envelope"></i>
                        </div>
                        <h3 class="empty-state-title">No Skills Subscribed</h3>
                        <p class="empty-state-text">This user has not subscribed to any skill alerts.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Search Done Tab -->
            <div class="tab-content" id="search_done">
                {% if applicant.get_search_done %}
                    {% for search in applicant.get_search_done %}
                    <div class="job-card">
                        <h3 class="job-title">
                            <a href="{% url 'dashboard:view_search_log' search.id %}">{{ search.search_text.skills }}</a>
                        </h3>
                        <div class="job-meta">
                            <span><i class="fa fa-calendar"></i> {{ search.search_on|timezone:'Asia/Calcutta' }}</span>
                            <span><i class="fa fa-briefcase"></i> {{ search.job_post }} Job Posts</span>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-search"></i>
                        </div>
                        <h3 class="empty-state-title">No Search History</h3>
                        <p class="empty-state-text">This user has not performed any searches yet.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Alerts Created Tab -->
            <div class="tab-content" id="alerts_created">
                {% if applicant.get_user_alerts %}
                    {% for alert in applicant.get_user_alerts %}
                    <div class="alert-card">
                        <h3 class="alert-title">
                            <a href="{% url 'my:job_alert_results' alert.id %}">{{ alert.name }}</a>
                        </h3>
                        <div class="alert-details">
                            <div class="alert-detail">
                                <div class="alert-detail-label">Skills</div>
                                <div class="alert-detail-value">
                                    {% for skill in alert.skill.all %}
                                        {{ skill.name }}{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="alert-detail">
                                <div class="alert-detail-label">Locations</div>
                                <div class="alert-detail-value">
                                    {% if alert.location.all %}
                                        {% for location in alert.location.all %}
                                            {{ location.name }}{% if not forloop.last %}, {% endif %}
                                        {% endfor %}
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </div>
                            </div>
                            <div class="alert-detail">
                                <div class="alert-detail-label">Experience</div>
                                <div class="alert-detail-value">
                                    {% if alert.min_year or alert.max_year %}
                                        {{ alert.min_year }} Year(s) - {{ alert.max_year }} Year(s)
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </div>
                            </div>
                            <div class="alert-detail">
                                <div class="alert-detail-label">Salary</div>
                                <div class="alert-detail-value">
                                    {% if alert.min_salary or alert.max_salary %}
                                        <i class="fa fa-inr"></i> {{ alert.min_salary|get_formatted_salary }} - {{ alert.max_salary|get_formatted_salary }}
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </div>
                            </div>
                            <div class="alert-detail">
                                <div class="alert-detail-label">Role</div>
                                <div class="alert-detail-value">{{ alert.role|default:"Not specified" }}</div>
                            </div>
                            <div class="alert-detail">
                                <div class="alert-detail-label">Industries</div>
                                <div class="alert-detail-value">
                                    {% if alert.industry.all %}
                                        {% for industry in alert.industry.all %}
                                            {{ industry.name }}{% if not forloop.last %}, {% endif %}
                                        {% endfor %}
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fa fa-bell"></i>
                        </div>
                        <h3 class="empty-state-title">No Job Alerts</h3>
                        <p class="empty-state-text">This user has not created any job alerts yet.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
    // Tab functionality
    document.addEventListener('DOMContentLoaded', function() {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                // Remove active class from all buttons and contents
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked button and corresponding content
                this.classList.add('active');
                document.getElementById(targetTab).classList.add('active');
            });
        });

        // Resume download functionality
        document.querySelectorAll('.download').forEach(element => {
            element.addEventListener('click', function(e) {
                e.preventDefault();
                window.location = this.getAttribute('id');
            });
        });
    });
</script>
{% endblock %}